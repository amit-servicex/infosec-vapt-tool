id: web.zap
version: "0.3.0"
type: scan
capabilities: [passive, active, web]
entrypoint: main.py
inputs:
  - target_url?           # direct target (optional if you use config_file)
  - mode?                 # "baseline" | "full"
  - ajax_spider?
  - max_duration_min?
  - risk_threshold?
  - include_patterns?
  - exclude_patterns?
  - debug?
  - extra_zap?            # list of "-config ..." strings
  - config_file?          # NEW: YAML/JSON file with the above keys
  - extra_zap_file?       # NEW: one "-config ..." per line
  - docker_image?         # override image if needed
  - docker_extra_args?    # e.g. ["--network", "host"]
outputs:
  - artifacts: ["zap-*.html", "zap-*.json", "zap-debug.log"]
  - findings: true
capabilities: [ passive, active, web ]
